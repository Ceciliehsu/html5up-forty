<!DOCTYPE HTML>
<!--
	Forty by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>MARKET</title>
    <meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
        <script type="text/javascript" src="https://canvasjs.com/assets/script/jquery-1.11.1.min.js"></script>
<script type="text/javascript" src="https://canvasjs.com/assets/script/canvasjs.stock.min.js"></script>
    </head>
	<body class="is-preload" style="background-color:rgb(47,70,110) ">
    
		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Header -->
					<header id="header" class="alt">
						<a href="index.html" class="logo"><strong>WIN</strong> <span>THE JACKPOT</span></a>
						<nav>
							<a href="#menu">Menu</a>
						</nav>
					</header>

				<!-- Menu -->
					<nav id="menu">
						<ul class="links">
							<li><a href="index.html">Home</a></li>
							<li><a href="market.html">Market</a></li>
							<li><a href="news.html">News</a></li>
							<li><a href="https://alvintang0925.github.io/QTSweb/">WatchList</a></li>
							<li><a href="elements.html">Game</a></li>
							<li><a href="elements.html">Setting</a></li>
						</ul>
						<ul class="actions stacked">
							<li><a href="#" class="button primary fit">Get Started</a></li>
							<li><a href="#" class="button fit">Log In</a></li>
						</ul>
					</nav>

				<!-- Banner -->
					<section id="banner" class="major">
						<div class="inner">
							<header class="major">
								<h1>MARKET</h1>
							</header>
							<div class="content">
								<p>股金中外，值得信賴</p>
								<ul class="actions">
									<li><a href="#one" class="button next scrolly">Get Started</a></li>
								</ul>
							</div>
						</div>
					</section>

				<!-- Main -->
                <div >
                    <!-- 股價圖-->
                    <!--button type="button" onclick="dooutput()">確認</button-->
                    <center><h2 >歷史股價</h2></center>
                    <center><input type="month" id="start" value="2019-11" min="2009-12" max="2019-11"  style = "height: 46px; " ><input type="month" id="end" value="2019-11" min="2009-12" max="2019-11"  style = "height: 46px; " ><button onclick="getcsv()">確認</button></center>
                    <center><div id="stockChartContainer" style="height: 400px; width: 80%;"></div></center>
                    
                    <!-- 股價表-->
                    <center><table id="fruit_table" style="height: 150px; width: 70%;">     
                         <colgroup>
                           <col style="background:rgb(8, 0, 0)">
                           <col span="5" style="background:rgb(7, 0, 0)">
                         </colgroup>
                         <h2 >今日股價</h2>
                         <thead>
                           <tr>
                             <th id="fruit_name">NAME</th>
                             <th id="fruit_price">LAST</th>
                             <th id="fruit_inventory">HIGH</th>
                             <th id="fruit_inventory">LOW</th>
                             <th id="fruit_inventory">CHG.</th>
                             <th id="fruit_inventory">VOL.</th>
                           </tr>
                         </thead>
                         <tbody>
                           <tr>
                             <td headers="fruit_name" style="font-weight:bold;"><input type="button" id="0" name="mybutton" value="AAPL"  onclick="dooutput(this)"></td>
                             <td headers="fruit_price">164.35</td>
                             <td headers="fruit_inventory">164.39</td>
                             <td headers="fruit_price">161.64</td>
                             <td headers="fruit_inventory " style="color:green;">+0.84%</td>
                             <td headers="fruit_inventory">1.14M</td>
                           </tr>
                           <tr>
                             <td headers="fruit_name" style="font-weight:bold;"><input type="button" id="1" name="mybutton" value="AXP" onclick="dooutput(this)"></td>
                             <td headers="fruit_price">132.21</td>
                             <td headers="fruit_inventory">132.90</td>
                             <td headers="fruit_price">130.53</td>
                             <td headers="fruit_inventory" style="color:green;">+2.43%</td>
                             <td headers="fruit_inventory">71.37M</td>
                           </tr>
                           <tr>
                             <td headers="fruit_name" style="font-weight:bold;"><input type="button" id="2" name="mybutton" value="BA" onclick="dooutput(this)"></td>
                             <td headers="fruit_price">41.92</td>
                             <td headers="fruit_inventory">42.03</td>
                             <td headers="fruit_price">41.50</td>
                             <td headers="fruit_inventory" style="color:red;">-0.70%</td>
                             <td headers="fruit_inventory">9.18M</td>
                           </tr>
                           <tr>
                            <td headers="fruit_name" style="font-weight:bold;"><input type="button" id="3" name="mybutton" value="CAT" onclick="dooutput(this)"></td>
                            <td headers="fruit_price">164.35</td>
                            <td headers="fruit_inventory">164.39</td>
                            <td headers="fruit_price">161.64</td>
                            <td headers="fruit_inventory " style="color:green;">+0.84%</td>
                            <td headers="fruit_inventory">1.14M</td>
                          </tr>
                          <tr>
                            <td headers="fruit_name" style="font-weight:bold;"><input type="button" id="4" name="mybutton" value="CSCO" onclick="dooutput(this)"></td>
                            <td headers="fruit_price">132.21</td>
                            <td headers="fruit_inventory">132.90</td>
                            <td headers="fruit_price">130.53</td>
                            <td headers="fruit_inventory" style="color:green;">+2.43%</td>
                            <td headers="fruit_inventory">71.37M</td>
                          </tr>
                          <tr>
                            <td headers="fruit_name" style="font-weight:bold;"><input type="button" id="5" name="mybutton" value="CVX" onclick="dooutput(this)"></td>
                            <td headers="fruit_price">41.92</td>
                            <td headers="fruit_inventory">42.03</td>
                            <td headers="fruit_price">41.50</td>
                            <td headers="fruit_inventory" style="color:red;">-0.70%</td>
                            <td headers="fruit_inventory">9.18M</td>
                          </tr>
                          <tr>
                            <td headers="fruit_name" style="font-weight:bold;"><input type="button" id="6" name="mybutton" value="DIS" onclick="dooutput(this)"></td>
                            <td headers="fruit_price">164.35</td>
                            <td headers="fruit_inventory">164.39</td>
                            <td headers="fruit_price">161.64</td>
                            <td headers="fruit_inventory " style="color:green;">+0.84%</td>
                            <td headers="fruit_inventory">1.14M</td>
                          </tr>
                          <tr>
                            <td headers="fruit_name" style="font-weight:bold;"><input type="button" id="7" name="mybutton" value="DD" onclick="dooutput(this)"></td>
                            <td headers="fruit_price">132.21</td>
                            <td headers="fruit_inventory">132.90</td>
                            <td headers="fruit_price">130.53</td>
                            <td headers="fruit_inventory" style="color:green;">+2.43%</td>
                            <td headers="fruit_inventory">71.37M</td>
                          </tr>
                          <tr>
                            <td headers="fruit_name" style="font-weight:bold;"><input type="button" id="8 "name="mybutton" value="GS" onclick="dooutput(this)"></td>
                            <td headers="fruit_price">41.92</td>
                            <td headers="fruit_inventory">42.03</td>
                            <td headers="fruit_price">41.50</td>
                            <td headers="fruit_inventory" style="color:red;">-0.70%</td>
                            <td headers="fruit_inventory">9.18M</td>
                          </tr>
                          <tr>
                            <td headers="fruit_name" style="font-weight:bold;"><input type="button" id="9" name="mybutton" value="HD" onclick="dooutput(this)"></td>
                            <td headers="fruit_price">164.35</td>
                            <td headers="fruit_inventory">164.39</td>
                            <td headers="fruit_price">161.64</td>
                            <td headers="fruit_inventory " style="color:green;">+0.84%</td>
                            <td headers="fruit_inventory">1.14M</td>
                          </tr>
                          <tr>
                            <td headers="fruit_name" style="font-weight:bold;"><input type="button" id="10" name="mybutton" value="IBM" onclick="dooutput(this)"></td>
                            <td headers="fruit_price">132.21</td>
                            <td headers="fruit_inventory">132.90</td>
                            <td headers="fruit_price">130.53</td>
                            <td headers="fruit_inventory" style="color:green;">+2.43%</td>
                            <td headers="fruit_inventory">71.37M</td>
                          </tr>
                          <tr>
                            <td headers="fruit_name" style="font-weight:bold;"><input type="button" id="11" name="mybutton" value="INTC" onclick="dooutput(this)"></td>
                            <td headers="fruit_price">41.92</td>
                            <td headers="fruit_inventory">42.03</td>
                            <td headers="fruit_price">41.50</td>
                            <td headers="fruit_inventory" style="color:red;">-0.70%</td>
                            <td headers="fruit_inventory">9.18M</td>
                          </tr>
                          <tr>
                            <td headers="fruit_name" style="font-weight:bold;"><input type="button" id="12" name="mybutton" value="JNJ" onclick="dooutput(this)"></td>
                            <td headers="fruit_price">164.35</td>
                            <td headers="fruit_inventory">164.39</td>
                            <td headers="fruit_price">161.64</td>
                            <td headers="fruit_inventory " style="color:green;">+0.84%</td>
                            <td headers="fruit_inventory">1.14M</td>
                          </tr>
                          <tr>
                            <td headers="fruit_name" style="font-weight:bold;"><input type="button" id="13" name="mybutton" value="KO" onclick="dooutput(this)"></td>
                            <td headers="fruit_price">132.21</td>
                            <td headers="fruit_inventory">132.90</td>
                            <td headers="fruit_price">130.53</td>
                            <td headers="fruit_inventory" style="color:green;">+2.43%</td>
                            <td headers="fruit_inventory">71.37M</td>
                          </tr>
                          <tr>
                            <td headers="fruit_name" style="font-weight:bold;"><input type="button" id="14" name="mybutton" value="MCD" onclick="dooutput(this)"></td>
                            <td headers="fruit_price">41.92</td>
                            <td headers="fruit_inventory">42.03</td>
                            <td headers="fruit_price">41.50</td>
                            <td headers="fruit_inventory" style="color:red;">-0.70%</td>
                            <td headers="fruit_inventory">9.18M</td>
                          </tr>
                          <tr>
                            <td headers="fruit_name" style="font-weight:bold;"><input type="button" id="15" name="mybutton" value="MMM" onclick="dooutput(this)"></td>
                            <td headers="fruit_price">164.35</td>
                            <td headers="fruit_inventory">164.39</td>
                            <td headers="fruit_price">161.64</td>
                            <td headers="fruit_inventory " style="color:green;">+0.84%</td>
                            <td headers="fruit_inventory">1.14M</td>
                          </tr>
                          <tr>
                            <td headers="fruit_name" style="font-weight:bold;"><input type="button" id="16" name="mybutton" value="MRK" onclick="dooutput(this)"></td>
                            <td headers="fruit_price">132.21</td>
                            <td headers="fruit_inventory">132.90</td>
                            <td headers="fruit_price">130.53</td>
                            <td headers="fruit_inventory" style="color:green;">+2.43%</td>
                            <td headers="fruit_inventory">71.37M</td>
                          </tr>
                          <tr>
                            <td headers="fruit_name" style="font-weight:bold;"><input type="button" id="17" name="mybutton" value="MSFT" onclick="dooutput(this)"></td>
                            <td headers="fruit_price">41.92</td>
                            <td headers="fruit_inventory">42.03</td>
                            <td headers="fruit_price">41.50</td>
                            <td headers="fruit_inventory" style="color:red;">-0.70%</td>
                            <td headers="fruit_inventory">9.18M</td>
                          </tr>
                          <tr>
                            <td headers="fruit_name" style="font-weight:bold;"><input type="button" id="18" name="mybutton" value="NKE" onclick="dooutput(this)"></td>
                            <td headers="fruit_price">164.35</td>
                            <td headers="fruit_inventory">164.39</td>
                            <td headers="fruit_price">161.64</td>
                            <td headers="fruit_inventory " style="color:green;">+0.84%</td>
                            <td headers="fruit_inventory">1.14M</td>
                          </tr>
                          <tr>
                            <td headers="fruit_name" style="font-weight:bold;"><input type="button" id="19" name="mybutton" value="PFE" onclick="dooutput(this)"></td>
                            <td headers="fruit_price">132.21</td>
                            <td headers="fruit_inventory">132.90</td>
                            <td headers="fruit_price">130.53</td>
                            <td headers="fruit_inventory" style="color:green;">+2.43%</td>
                            <td headers="fruit_inventory">71.37M</td>
                          </tr>
                          <tr>
                            <td headers="fruit_name" style="font-weight:bold;"><input type="button" id="20" name="mybutton" value="PG" onclick="dooutput(this)"></td>
                            <td headers="fruit_price">41.92</td>
                            <td headers="fruit_inventory">42.03</td>
                            <td headers="fruit_price">41.50</td>
                            <td headers="fruit_inventory" style="color:red;">-0.70%</td>
                            <td headers="fruit_inventory">9.18M</td>
                          </tr>
                          <tr>
                            <td headers="fruit_name" style="font-weight:bold;"><input type="button" id="21" name="mybutton" value="TRV" onclick="dooutput(this)"></td>
                            <td headers="fruit_price">164.35</td>
                            <td headers="fruit_inventory">164.39</td>
                            <td headers="fruit_price">161.64</td>
                            <td headers="fruit_inventory " style="color:green;">+0.84%</td>
                            <td headers="fruit_inventory">1.14M</td>
                          </tr>
                          <tr>
                            <td headers="fruit_name" style="font-weight:bold;"><input type="button" id="22" name="mybutton" value="UNH" onclick="dooutput(this)"></td>
                            <td headers="fruit_price">132.21</td>
                            <td headers="fruit_inventory">132.90</td>
                            <td headers="fruit_price">130.53</td>
                            <td headers="fruit_inventory" style="color:green;">+2.43%</td>
                            <td headers="fruit_inventory">71.37M</td>
                          </tr>
                          <tr>
                            <td headers="fruit_name" style="font-weight:bold;"><input type="button" id="23" name="mybutton" value="UTX" onclick="dooutput(this)"></td>
                            <td headers="fruit_price">41.92</td>
                            <td headers="fruit_inventory">42.03</td>
                            <td headers="fruit_price">41.50</td>
                            <td headers="fruit_inventory" style="color:red;">-0.70%</td>
                            <td headers="fruit_inventory">9.18M</td>
                          </tr>
                          <tr>
                            <td headers="fruit_name" style="font-weight:bold;"><input type="button" id="24" name="mybutton" value="V" onclick="dooutput(this)"></td>
                            <td headers="fruit_price">164.35</td>
                            <td headers="fruit_inventory">164.39</td>
                            <td headers="fruit_price">161.64</td>
                            <td headers="fruit_inventory " style="color:green;">+0.84%</td>
                            <td headers="fruit_inventory">1.14M</td>
                          </tr>
                          <tr>
                            <td headers="fruit_name" style="font-weight:bold;"><input type="button" id="25" name="mybutton" value="VZ" onclick="dooutput(this)"></td>
                            <td headers="fruit_price">132.21</td>
                            <td headers="fruit_inventory">132.90</td>
                            <td headers="fruit_price">130.53</td>
                            <td headers="fruit_inventory" style="color:green;">+2.43%</td>
                            <td headers="fruit_inventory">71.37M</td>
                          </tr>
                          <tr>
                            <td headers="fruit_name" style="font-weight:bold;"><input type="button" id="26" name="mybutton" value="BA" onclick="dooutput(this)"></td>
                            <td headers="fruit_price">41.92</td>
                            <td headers="fruit_inventory">42.03</td>
                            <td headers="fruit_price">41.50</td>
                            <td headers="fruit_inventory" style="color:red;">-0.70%</td>
                            <td headers="fruit_inventory">9.18M</td>
                          </tr>
                          <tr>
                            <td headers="fruit_name" style="font-weight:bold;"><input type="button" id="27" name="mybutton" value="WBA" onclick="dooutput(this)"></td>
                            <td headers="fruit_price">164.35</td>
                            <td headers="fruit_inventory">164.39</td>
                            <td headers="fruit_price">161.64</td>
                            <td headers="fruit_inventory " style="color:green;">+0.84%</td>
                            <td headers="fruit_inventory">1.14M</td>
                          </tr>
                          <tr>
                            <td headers="fruit_name" style="font-weight:bold;"><input type="button" id="28" name="mybutton" value="WMT" onclick="dooutput(this)"></td>
                            <td headers="fruit_price">132.21</td>
                            <td headers="fruit_inventory">132.90</td>
                            <td headers="fruit_price">130.53</td>
                            <td headers="fruit_inventory" style="color:green;">+2.43%</td>
                            <td headers="fruit_inventory">71.37M</td>
                          </tr>
                          <tr>
                            <td headers="fruit_name" style="font-weight:bold;"><input type="button" id="29" name="mybutton" value="XOM" onclick="dooutput(this)"></td>
                            <td headers="fruit_price">41.92</td>
                            <td headers="fruit_inventory">42.03</td>
                            <td headers="fruit_price">41.50</td>
                            <td headers="fruit_inventory" style="color:red;">-0.70%</td>
                            <td headers="fruit_inventory">9.18M</td>
                          </tr>
                         </tbody>
                       </table></center>
                    </div>
			</div>

		<!-- Scripts -->
    
      <script type="text/javascript">
         var company = [],tmp = [],m = [];
         for(var j =0;j<30;j++){
            tmp[j] = [];
            company[j] = [];
          }
          var syear,smonth,eyear,emonth,mindex = 0,index;
          function getcsv(myObj){
            index = 0;
            for(var j =0;j<30;j++){
              tmp[j] = [];
              company[j] = [];
            }
            var start = document.getElementById("start");
            //console.log(start.value.split('-'));
            var tempm = start.value.split('-');
            syear = parseInt(tempm[0]);
            smonth = parseInt(tempm[1]);
            var end = document.getElementById("end");
            //console.log(end.value.split('-'));
            tempm = end.value.split('-');
            eyear = parseInt(tempm[0]);
            emonth = parseInt(tempm[1]); 
            var i,j = 0,count = 0,year = 0,month = 0;
            if(eyear == syear ){
              index = 0;
              if(emonth == smonth){
                if( emonth <10)
                  var filename = "M2M/train_"+String(eyear)+"_0"+String(emonth)+"("+String(syear)+" Q1).csv";
                else
                var filename = "M2M/train_"+String(eyear)+"_"+String(emonth)+"("+String(syear)+" Q1).csv";
                getdata(filename,company);
                
                }
              else if(emonth > smonth){
                count = emonth - smonth+1;
                month = smonth;
                year = syear ;
                for(i = 0;i < count ;i ++){
                if(month <10)
                  var filename = "M2M/train_"+String(year)+"_0"+String(month)+"("+String(year)+" Q1).csv";
                else
                  var filename = "M2M/train_"+String(year)+"_"+String(month)+"("+String(year)+" Q1).csv";
                getdata(filename,tmp);
                month++ ;
              }
              }
              else
                alert("請輸入正確日期");
              }
            else if(eyear > syear){
              index = 0;
              if(emonth > smonth){
                count = eyear - syear-1;
                count *= 12;
                count += 12 + emonth - smonth + 1;
              }
              else if (emonth <= smonth){
                count = eyear - syear ;
                count *= 12;
                count += emonth - smonth+1;
            }
              month = smonth;
              year = syear;
              for(i = 0;i < count ;i ++){
                if(month <10)
                  var filename = "M2M/train_"+String(year)+"_0"+String(month)+"("+String(year)+" Q1).csv";
                else
                  var filename = "M2M/train_"+String(year)+"_"+String(month)+"("+String(year)+" Q1).csv";
                getdata(filename,company);
                if(month == 12){
                  month = 1;
                  year += 1;
                  }
                else  
                  month++ ;
              }
            }
            else{
              alert("請輸入正確日期");
            }
           // var filename = "M2M/train_"+year+"_"+month+"("+year+" Q1).csv";
            //getdata(filename,company);
        }
        async function getdata(filename,tmp){
          var k=0,c=0;
          const response = await fetch(filename);
          const data = await response.text();
          //console.log(data);
          const rows = data.split('\n');
          rows.forEach(elt => {
            c++;
          })
          rows.forEach(elt => {
            const row = elt.split(',');
            //console.log(row);
            /*for(var j=0; j<30; j++){
              company[j][i]=row[j];
              if(i > 0)
                company[j][i] = parseFloat(company[j][i]);
            }*/
            for(var j=0; j<30; j++){
              //if(j == 0 && k == )
              if((c - k) == 1)
                break;
              else if(k != 0 ){
                company[j][index-1] = parseFloat(row[j]);
                //tmp[j][index-1]=row[j];
                //console.log(row[j]);
                //console.log(c);
                //console.log(index);
                //console.log(k);
                //console.log(tmp[j][index]); 
                //console.log(company[j][index]);
              }
              else{}
                //console.log(row[j]);
              //console.log(tmp[0])
              //console.log(company[0]);
        }
          k++; 
          index++;
        })
        index -= 2;
        }
        function dooutput(myObj){
          console.log(company[0]);
        var dataPoints = [];
        var y = 0,count = 0;
        var data = [];var dataSeries = { type: "spline" };
        var dataPoints = [];
        var tmp = parseInt(myObj.id);
        var start = document.getElementById("start");
        var tempm = start.value.split('-');
        syear = parseInt(tempm[0]);
        smonth = parseInt(tempm[1])-1;
        var end = document.getElementById("end");
        tempm = end.value.split('-');
        eyear = parseInt(tempm[0]);
        emonth = parseInt(tempm[1]); 
        for(var j = 0;j < company[0].length-1;j++){
              //dataPoints.push({x: j,y:company[tmp][j]});
          //console.log(j);
          if(count < 20){
            count ++;
            dataPoints.push({x: new Date(syear,smonth,count),y:company[tmp][j]});
          }
          else{
            if(smonth == 12){
              dataPoints.push({x: new Date(syear,smonth,count),y:company[tmp][j]});
              syear ++;
              smonth = 1;
              count = 0;
            }
            else{
            dataPoints.push({x: new Date(syear,smonth,count),y:company[tmp][j]});
            count = 0;
            smonth++;
            }
          }
        }
        tempm = start.value.split('-');
        syear = parseInt(tempm[0]);
        smonth = parseInt(tempm[1])-1;
        dataSeries.dataPoints = dataPoints;
        data.push(dataSeries);
        var stockChart = new CanvasJS.StockChart("stockChartContainer", {
        exportEnabled: true,
        animationEnabled: true,
        // exportEnabled: true,
    title: {
      text:myObj.value +"  歷史股價"
    },
    charts: [{
      axisX: {  
        viewportMinimum: 0,
        minimum:0,
        title: "Date",
        crosshair: { 
          enabled: true,
          snapToDataPoint: true,
        }
      },
      axisY: {
        //viewportMinimum: 1,
        title: "Dollars",
        prefix: "$",
        crosshair: {
          enabled: true,
          //snapToDataPoint: true,
        }
      },
      data: [{
        type: "line",
        yValueFormatString: "$#,###.##",
        dataPoints : dataPoints
      }]
    }],
    data:data,
    navigator: {
      slider: {
        minimum: new Date(syear, smonth, 01),
        maximum: new Date(eyear, emonth, 20)
      }
    }
  ,
    rangeSelector: {
        enabled:true,
        inputFields: {
          viewportMinimum: 1,
          minimum:1,
          //endValue: 20,
          valueFormatString: 	"MM-DD-YYYY"
        },
        buttons: [{
          label: "a week",        
          range: 1,
          rangeType: "week"
        },{
          label: "a month",        
          range: 1,
          rangeType: "month"
        },{
          label: "a season",        
          range: 3,
          rangeType: "month"
        },{
          label: "a year",        
          range: 1,
          rangeType: "year"
        },
        {
        label: "All ",        
        rangeType: "all"
      }]
      }
  });
    stockChart.render();
}
      </script>
     
      <script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>
	</body>
</html>